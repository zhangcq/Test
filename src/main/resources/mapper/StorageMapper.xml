<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.mas.graduate.mapper.StorageMapper">
    <select id="getAllStorageByPage" resultType="Storage" parameterType="Storage">
  		select * from(select rownum r,t1.* from (select storageid storageId,storagenum storageNum,location,area,type
        from storage
  		where status=1
  		<if test="storageNum != null and storageNum != ''">
  		    and storagenum = #{storageNum} 
  		</if>
  		<if test="location != null and location != ''">
  		    and location = #{location} 
  		</if>
  		<if test="type != null and type != ''">
  		    and type = #{type} 
  		</if>
  		) t1)t2      where t2.r  &lt;=(#{pageNumber}+#{pageSize}) and t2.r  &gt;#{pageNumber}
    	
    </select>
    
    <select id="getAllStorage" resultType="int" parameterType="Storage">
  		select count(1) from storage
  		where 1=1
  		<if test="storageNum != null and storageNum != ''">
  		    and storagenum = #{storageNum} 
  		</if>
  		<if test="location != null and location != ''">
  		    and location = #{location} 
  		</if>
  		<if test="type != null and type != ''">
  		    and type = #{type} 
  		</if>
    </select>
    
    <insert id="addStorage" parameterType="Storage">
        insert into storage values(seq_storageid.nextval,#{storageNum},#{location},#{area},#{type},1)
    </insert>
    
    <update id="editStorage" parameterType="Storage">
        update storage set storagenum=#{storageNum},location=#{location},area=#{area},type=#{type} where storageid=#{storageId}
    </update>
    
    <update id="deleteStorage" parameterType="Storage">
        update storage set status=0 where storageid = #{storageId}
    </update>
</mapper>

